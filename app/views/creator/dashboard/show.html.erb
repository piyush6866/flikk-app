<div class="min-h-screen pt-20 pb-16 bg-slate-50">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <!-- Header Row -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">
      <div>
        <h1 class="text-2xl font-semibold text-slate-900">Dashboard</h1>
        <p class="text-sm text-slate-500 mt-0.5">Manage your applications and earnings</p>
      </div>
      <div class="flex items-center gap-6 text-sm">
        <div class="flex items-center gap-2">
          <span class="text-slate-500">Earned</span>
          <span class="font-semibold text-slate-900">₹<%= number_with_delimiter(@total_earned) %></span>
        </div>
        <div class="w-px h-4 bg-slate-200"></div>
        <div class="flex items-center gap-2">
          <span class="text-slate-500">Pending</span>
          <span class="font-semibold text-emerald-600">₹<%= number_with_delimiter(@pending_payout) %></span>
        </div>
      </div>
    </div>

    <!-- Quick Stats Row -->
    <div class="flex items-center gap-6 mb-6 overflow-x-auto pb-2">
      <div class="flex items-center gap-2 px-3 py-1.5 bg-white rounded-full border border-slate-200 text-sm whitespace-nowrap">
        <span class="w-2 h-2 rounded-full bg-amber-400"></span>
        <span class="text-slate-600">Pending</span>
        <span class="font-medium text-slate-900"><%= @pending_approval.count %></span>
      </div>
      <div class="flex items-center gap-2 px-3 py-1.5 bg-white rounded-full border border-slate-200 text-sm whitespace-nowrap">
        <span class="w-2 h-2 rounded-full bg-indigo-500"></span>
        <span class="text-slate-600">Ready to Upload</span>
        <span class="font-medium text-slate-900"><%= @ready_to_upload.count %></span>
      </div>
      <div class="flex items-center gap-2 px-3 py-1.5 bg-white rounded-full border border-slate-200 text-sm whitespace-nowrap">
        <span class="w-2 h-2 rounded-full bg-blue-500"></span>
        <span class="text-slate-600">Under Review</span>
        <span class="font-medium text-slate-900"><%= @under_review.count %></span>
      </div>
      <div class="flex items-center gap-2 px-3 py-1.5 bg-white rounded-full border border-slate-200 text-sm whitespace-nowrap">
        <span class="w-2 h-2 rounded-full bg-emerald-500"></span>
        <span class="text-slate-600">Completed</span>
        <span class="font-medium text-slate-900"><%= @completed_tasks.count %></span>
      </div>
    </div>

    <!-- Main Content Card -->
    <div class="bg-white rounded-xl border border-slate-200 shadow-sm" data-controller="tabs">
      <!-- Tabs Navigation -->
      <div class="border-b border-slate-200">
        <nav class="flex -mb-px">
          <button 
            data-tabs-target="tab" 
            data-action="click->tabs#switch" 
            data-tab="pending"
            class="tab-btn px-5 py-3 text-sm font-medium border-b-2 border-indigo-500 text-indigo-600">
            Pending
            <% if @pending_approval.any? %>
              <span class="ml-1.5 text-xs bg-slate-100 text-slate-600 px-1.5 py-0.5 rounded"><%= @pending_approval.count %></span>
            <% end %>
          </button>
          <button 
            data-tabs-target="tab" 
            data-action="click->tabs#switch" 
            data-tab="upload"
            class="tab-btn px-5 py-3 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-slate-700">
            Ready to Upload
            <% if @ready_to_upload.any? %>
              <span class="ml-1.5 text-xs bg-slate-100 text-slate-600 px-1.5 py-0.5 rounded"><%= @ready_to_upload.count %></span>
            <% end %>
          </button>
          <button 
            data-tabs-target="tab" 
            data-action="click->tabs#switch" 
            data-tab="review"
            class="tab-btn px-5 py-3 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-slate-700">
            Under Review
            <% if @under_review.any? %>
              <span class="ml-1.5 text-xs bg-slate-100 text-slate-600 px-1.5 py-0.5 rounded"><%= @under_review.count %></span>
            <% end %>
          </button>
          <button 
            data-tabs-target="tab" 
            data-action="click->tabs#switch" 
            data-tab="completed"
            class="tab-btn px-5 py-3 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-slate-700">
            Completed
            <% if @completed_tasks.any? %>
              <span class="ml-1.5 text-xs bg-slate-100 text-slate-600 px-1.5 py-0.5 rounded"><%= @completed_tasks.count %></span>
            <% end %>
          </button>
        </nav>
      </div>

      <!-- Tab Content: Pending Approval -->
      <div data-tabs-target="content" data-tab="pending" class="p-5">
        <% if @pending_approval.any? %>
          <div class="space-y-3">
            <% @pending_approval.each do |submission| %>
              <%= render 'creator/dashboard/submission_card', submission: submission %>
            <% end %>
          </div>
        <% else %>
          <div class="text-center py-10">
            <p class="text-slate-500 text-sm mb-3">No pending applications</p>
            <%= link_to campaigns_path, class: "text-sm text-indigo-600 font-medium hover:text-indigo-700" do %>
              Browse Opportunities →
            <% end %>
          </div>
        <% end %>
      </div>

      <!-- Tab Content: Ready to Upload -->
      <div data-tabs-target="content" data-tab="upload" class="p-5 hidden">
        <% if @ready_to_upload.any? %>
          <div class="space-y-3">
            <% @ready_to_upload.each do |submission| %>
              <%= render 'creator/dashboard/submission_card', submission: submission %>
            <% end %>
          </div>
        <% else %>
          <div class="text-center py-10">
            <p class="text-slate-500 text-sm">Approved applications will appear here for upload</p>
          </div>
        <% end %>
      </div>

      <!-- Tab Content: Under Review -->
      <div data-tabs-target="content" data-tab="review" class="p-5 hidden">
        <% if @under_review.any? %>
          <div class="space-y-3">
            <% @under_review.each do |submission| %>
              <%= render 'creator/dashboard/submission_card', submission: submission %>
            <% end %>
          </div>
        <% else %>
          <div class="text-center py-10">
            <p class="text-slate-500 text-sm">Submitted content will appear here</p>
          </div>
        <% end %>
      </div>

      <!-- Tab Content: Completed -->
      <div data-tabs-target="content" data-tab="completed" class="p-5 hidden">
        <% if @completed_tasks.any? %>
          <div class="space-y-3">
            <% @completed_tasks.each do |submission| %>
              <%= render 'creator/dashboard/submission_card', submission: submission %>
            <% end %>
          </div>
        <% else %>
          <div class="text-center py-10">
            <p class="text-slate-500 text-sm">Completed work will appear here</p>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Available Opportunities -->
    <% if @available_campaigns.any? %>
      <div class="mt-6">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-medium text-slate-900">New Opportunities</h2>
          <%= link_to campaigns_path, class: "text-sm text-indigo-600 font-medium hover:text-indigo-700" do %>
            View All →
          <% end %>
        </div>
        
        <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
          <% @available_campaigns.limit(3).each do |campaign| %>
            <div class="bg-white rounded-xl border border-slate-200 p-4 hover:border-slate-300 transition-colors">
              <div class="flex items-start justify-between mb-3">
                <div>
                  <h3 class="font-medium text-slate-900 text-sm"><%= campaign.product_name %></h3>
                  <p class="text-xs text-slate-500 mt-0.5"><%= campaign.scenario %> • <%= campaign.duration_label %></p>
                </div>
                <span class="text-sm font-semibold text-emerald-600"><%= campaign.formatted_price %></span>
              </div>
              <div class="flex items-center justify-between">
                <span class="text-xs text-slate-400">by <%= campaign.user.brand_name %></span>
                <%= button_to campaign_apply_path(campaign), method: :post, class: "px-3 py-1.5 bg-slate-900 text-white text-xs font-medium rounded-lg hover:bg-slate-800 transition-colors" do %>
                  Apply
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>

  </div>
</div>

<script>
  function initTabs() {
    const containers = document.querySelectorAll('[data-controller="tabs"]');
    
    containers.forEach(function(container) {
      if (container.dataset.initialized === 'true') return;
      container.dataset.initialized = 'true';
      
      const tabs = container.querySelectorAll('[data-tabs-target="tab"]');
      const contents = container.querySelectorAll('[data-tabs-target="content"]');
      
      tabs.forEach(function(tab) {
        tab.addEventListener('click', function() {
          const targetTab = tab.dataset.tab;
          
          tabs.forEach(function(t) {
            if (t.dataset.tab === targetTab) {
              t.classList.add('border-indigo-500', 'text-indigo-600');
              t.classList.remove('border-transparent', 'text-slate-500', 'hover:text-slate-700');
            } else {
              t.classList.remove('border-indigo-500', 'text-indigo-600');
              t.classList.add('border-transparent', 'text-slate-500', 'hover:text-slate-700');
            }
          });
          
          contents.forEach(function(content) {
            if (content.dataset.tab === targetTab) {
              content.classList.remove('hidden');
            } else {
              content.classList.add('hidden');
            }
          });
        });
      });
    });
  }
  
  document.addEventListener('DOMContentLoaded', initTabs);
  document.addEventListener('turbo:load', initTabs);
</script>
